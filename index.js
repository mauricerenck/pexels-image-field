(()=>{(function(){"use strict";var g=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"k-pexels-field"},[t("k-field",{attrs:{label:e.label}},[t("k-input",{attrs:{theme:"field",icon:"search",type:"text",name:"textfield",value:e.value},on:{input:e.onInput,keyup:e.onSubmit}})],1),t("div",[e.loading?t("div",{staticClass:"loader"},[t("k-loader")],1):e._e(),!e.loading&&e.photos.length>0?t("div",{staticClass:"imagegrid"},[t("k-grid",e._l(this.photos,function(s){return t("k-column",{key:s.id,attrs:{width:"1/6"}},[t("k-image",{attrs:{ratio:"16/9",cover:"true",src:s.small},on:{click:[function(r){return e.onSelect(s.id,s.large,s.photographer,s.photographerUrl,s.downloadUrl)},function(r){return e.$refs.dialog.open()}]}})],1)}),1),t("div",{staticClass:"prev-next"},[t("button",{staticClass:"k-link k-button",on:{click:e.showPrev}},[t("k-icon",{attrs:{type:"angle-left"}})],1),t("span",[e._v(e._s(e.pexelPage)+" of "+e._s(e.pages))]),t("button",{staticClass:"k-link k-button",on:{click:e.showNext}},[t("k-icon",{attrs:{type:"angle-right"}})],1)])],1):e._e()]),t("div",[t("k-dialog",{ref:"dialog",attrs:{submitButton:"Download",theme:"positive",icon:"download",size:"large"},on:{submit:e.downloadImage}},[e._v(" A photo by "),t("strong",[e._v(e._s(e.selectedPhoto.photographer))]),t("k-image",{attrs:{src:e.selectedPhoto.photo}})],1)],1)],1)},c=[],$="";function _(e,o,t,s,r,h,d,P){var i=typeof e=="function"?e.options:e;o&&(i.render=o,i.staticRenderFns=t,i._compiled=!0),s&&(i.functional=!0),h&&(i._scopeId="data-v-"+h);var a;if(d?(a=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(n=__VUE_SSR_CONTEXT__),r&&r.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(d)},i._ssrRegister=a):r&&(a=P?function(){r.call(this,(i.functional?this.parent:this).$root.$options.shadowRoot)}:r),a)if(i.functional){i._injectStyles=a;var w=i.render;i.render=function(y,u){return a.call(u),w(y,u)}}else{var p=i.beforeCreate;i.beforeCreate=p?[].concat(p,a):[a]}return{exports:e,options:i}}const f={props:{label:String,value:String,apiKey:String},data:function(){return{photos:[],selectedPhoto:{id:"",photo:"",photographer:"",photographerUrl:"",downloadUrl:""},keyword:"",pexelPage:1,remaining:0,totalResults:0,loading:!1,timer:null}},computed:{pageId(){return this.$store.getters["content/id"]()},pages(){return Math.round(this.totalResults/this.photos.length,10)}},methods:{onInput(e){this.keyword=e},onSubmit(e){this.timer!==null&&clearTimeout(this.timer),!(this.keyword.length<3)&&(this.timer=setTimeout(()=>{this.search(this.keyword)},250))},onSelect(e,o,t,s,r){this.selectedPhoto={id:e,photo:o,photographer:t,photographerUrl:s,downloadUrl:r}},showNext(){this.pexelPage*this.perPage>this.remaining||(this.pexelPage++,this.search(this.keyword))},showPrev(){this.pexelPage!==1&&(this.pexelPage--,this.search(this.keyword))},search(e){this.loading=!0,this.$api.get(`pexels/search/${e}/${this.pexelPage}`).then(o=>{this.photos=o.photos,this.page=o.page,this.perPage=o.perPage,this.remaining=o.remaining,this.totalResults=o.totalResults,this.loading=!1})},downloadImage(e){this.$api.post("pexels/download",{downloadUrl:this.selectedPhoto.downloadUrl,pageId:this.pageId.split("?")[0],imageId:this.selectedPhoto.id,photographer:this.selectedPhoto.photographer,photographerUrl:this.selectedPhoto.photographerUrl}).then(()=>{this.$refs.dialog.close()})}}},l={};var v=_(f,g,c,!1,m,null,null,null);function m(e){for(let o in l)this[o]=l[o]}var k=function(){return v.exports}();panel.plugin("mauricerenck/PexelsImageField",{fields:{pexels:k}})})();})();
